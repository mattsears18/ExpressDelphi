<template name="Results">
  <h1>Study Results</h1>

  {{#if ratings.count}}
    <div class="new-recipe-container">
      <table class="table table-striped table-bordered" id="resultsTable">
        <thead>
          <tr>
            <th>Alternative</th>
            {{#each criteria}}
              <th>{{name}}</th>
            {{/each}}
            <th>Final Weighted Score</th>
          </tr>
        </thead>
        <tbody>
          {{#each alternatives}}
            <tr>
              <td><a href="/studies/{{study._id}}/alternatives/{{_id}}">{{name}}</a></td>
              {{#each finalValues.scores}}
                <td>
                  {{#if consensusRound}}
                    <span class="badge badge-primary">Round {{consensusRound}}</span>&nbsp;&nbsp;
                  {{else}}
                    <span class="badge badge-danger">Round {{maxRound}}</span>&nbsp;&nbsp;
                  {{/if}}

                  {{finalValueRounded}} * ({{weightRounded}}%) = {{weightedValueRounded}}
                </td>
              {{/each}}
              <td><strong>{{finalValues.finalScoreRounded}}</strong></td>
            </tr>
          {{/each}}
        </tbody>
      </table>

      <div><span class="badge badge-primary">Round Consensus Reached</span></div>
      <div><span class="badge badge-danger">Consensus Not Reached, Last Rated Round</span></div>
    </div>
  {{else}}
    {{#if study.currentRound}}
      <div class="alert alert-danger" role="alert"><strong>No Ratings!</strong> <a href="/studies/{{study._id}}/rate">Rate</a> to see results.</div>
    {{else}}
      {{#if alternatives}}
        {{#if criteria}}
          <div class="alert alert-danger" role="alert"><strong>No Round Started!</strong> <a href="/studies/{{study._id}}">Start the first</a> round.</div>
        {{/if}}
      {{/if}}
    {{/if}}
  {{/if}}
</template>
